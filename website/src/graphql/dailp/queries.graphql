query CollectionsListing {
  allCollections {
    name
    slug
  }
}

query DocumentsPages {
  allDocuments {
    id
    slug
    isReference
  }
}

query AnnotatedDocument($id: String!) {
  document(id: $id) {
    id
    title
    slug
    isReference
    breadcrumbs(superCollection: "") {
      name
      slug
    }
    date {
      year
    }
    sources {
      name
      link
    }
    audioRecording {
      resourceUrl
      startTime
      endTime
    }
    translatedPages {
      image {
        url
      }
    }
  }
}

query DocumentContents(
  $id: String!
  $morphemeSystem: CherokeeOrthography
  $isReference: Boolean!
) {
  document(id: $id) {
    translatedPages @skip(if: $isReference) {
      pageNumber
      paragraphs {
        source {
          __typename
          ... on AnnotatedForm {
            ...FormFields
          }
        }
        translation
      }
    }
    forms @include(if: $isReference) {
      __typename
      ...FormFields
    }
  }
}

fragment FormFields on AnnotatedForm {
  index
  source
  romanizedSource
  simplePhonetics
  phonemic
  segments {
    morpheme(system: $morphemeSystem)
    gloss
    matchingTag(system: $morphemeSystem) {
      tag
      title
    }
    nextSeparator
  }
  englishGloss
  commentary
  audioTrack {
    index
    resourceUrl
    startTime
    endTime
  }
}

query Collection($slug: String!) {
  collection(slug: $slug) {
    name
    documents {
      id
      slug
      title
      date {
        year
      }
      orderIndex
    }
  }
}

query WordSearch($query: String!) {
  wordSearch(query: $query) {
    source
    normalizedSource
    simplePhonetics
    documentId
    englishGloss
  }
}

query AllSources {
  allDocuments {
    isReference
    id
    title
    date {
      year
    }
    contributors {
      name
    }
    formCount
  }
}

query Glossary($system: CherokeeOrthography!) {
  allTags(system: $system) {
    tag
    title
    definition
    morphemeType
  }
}

query Timeline($gloss: String!) {
  morphemeTimeClusters(gloss: $gloss, clusterYears: 50) {
    start {
      year
    }
    end {
      year
    }
    forms {
      source
      normalizedSource
      simplePhonetics
      phonemic
      documentId
      englishGloss
    }
  }
}

query DocumentDetails($id: String!) {
  document(id: $id) {
    id
    slug
    title
    breadcrumbs(superCollection: "") {
      name
      slug
    }
    date {
      year
    }
    contributors {
      name
      role
    }
    sources {
      name
      link
    }
  }
}

query EditablePage($id: String!) {
  page(id: $id) {
    id
    title
    body {
      __typename
      ... on Markdown {
        content
      }
    }
  }
}

query Tag($gloss: String!) {
  tag: morphemeTag(id: $gloss) {
    id
    morphemeType
    taoc {
      tag
      title
      definition
    }
    crg {
      tag
      title
      definition
    }
    learner {
      tag
      title
      definition
    }
  }
}

query Morpheme($morphemeId: String!) {
  documents: morphemesByDocument(morphemeId: $morphemeId) {
    documentId
    documentType
    forms {
      index
      source
      normalizedSource
      documentId
      englishGloss
    }
  }
}

mutation NewPage($data: JSON!) {
  updatePage(data: $data)
}
